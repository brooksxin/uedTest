(function(a,d){a.om=a.om||{};if(a.om.version){return}a.extend(a.om,{version:"2.0",keyCode:{TAB:9,ENTER:13,ESCAPE:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40},lang:{_get:function(g,f,e){return g[e]?g[e]:a.om.lang[f][e]}}});a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_oldFocus:a.fn.focus,focus:function(e,f){return typeof e==="number"?this.each(function(){var g=this;setTimeout(function(){a(g).focus();if(f){f.call(g)}},e)}):this._oldFocus.apply(this,arguments)},scrollParent:function(){var e;if((a.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){e=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(a.curCSS(this,"position",1))&&(/(auto|scroll)/).test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0)}else{e=this.parents().filter(function(){return(/(auto|scroll)/).test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0)}return(/fixed/).test(this.css("position"))||!e.length?a(document):e},zIndex:function(h){if(h!==d){return this.css("zIndex",h)}if(this.length){var f=a(this[0]),e,g;while(f.length&&f[0]!==document){e=f.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){g=parseInt(f.css("zIndex"),10);if(!isNaN(g)&&g!==0){return g}}f=f.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".om-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".om-disableSelection")}});a.each(["Width","Height"],function(g,e){var f=e==="Width"?["Left","Right"]:["Top","Bottom"],h=e.toLowerCase(),k={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};function j(m,l,i,n){a.each(f,function(){l-=parseFloat(a.curCSS(m,"padding"+this,true))||0;if(i){l-=parseFloat(a.curCSS(m,"border"+this+"Width",true))||0}if(n){l-=parseFloat(a.curCSS(m,"margin"+this,true))||0}});return l}a.fn["inner"+e]=function(i){if(i===d){return k["inner"+e].call(this)}return this.each(function(){a(this).css(h,j(this,i)+"px")})};a.fn["outer"+e]=function(i,l){if(typeof i!=="number"){return k["outer"+e].call(this,i)}return this.each(function(){a(this).css(h,j(this,i,true,l)+"px")})}});function c(g,e){var j=g.nodeName.toLowerCase();if("area"===j){var i=g.parentNode,h=i.name,f;if(!g.href||!h||i.nodeName.toLowerCase()!=="map"){return false}f=a("img[usemap=#"+h+"]")[0];return !!f&&b(f)}return(/input|select|textarea|button|object/.test(j)?!g.disabled:"a"==j?g.href||e:e)&&b(g)}function b(e){return !a(e).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.extend(a.expr[":"],{data:function(g,f,e){return !!a.data(g,e[3])},focusable:function(e){return c(e,!isNaN(a.attr(e,"tabindex")))},tabbable:function(g){var e=a.attr(g,"tabindex"),f=isNaN(e);return(f||e>=0)&&c(g,!f)}});a(function(){var e=document.body,f=e.appendChild(f=document.createElement("div"));a.extend(f.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=f.offsetHeight===100;a.support.selectstart="onselectstart" in f;e.removeChild(f).style.display="none"});a.extend(a.om,{plugin:{add:function(f,g,j){var h=a.om[f].prototype;for(var e in j){h.plugins[e]=h.plugins[e]||[];h.plugins[e].push([g,j[e]])}},call:function(e,g,f){var j=e.plugins[g];if(!j||!e.element[0].parentNode){return}for(var h=0;h<j.length;h++){if(e.options[j[h][0]]){j[h][1].apply(e.element,f)}}}}})})(jQuery);(function(a,c){if(a.cleanData){var b=a.cleanData;a.cleanData=function(d){for(var e=0,f;(f=d[e])!=null;e++){a(f).triggerHandler("om-remove")}b(d)}}a.omWidget=function(e,g,d){var f=e.split(".")[0],i;e=e.split(".")[1];i=f+"-"+e;if(!d){d=g;g=a.OMWidget}a.expr[":"][i]=function(j){return !!a.data(j,e)};a[f]=a[f]||{};a[f][e]=function(j,k){if(arguments.length){this._createWidget(j,k)}};var h=new g();h.options=a.extend(true,{},h.options);a[f][e].prototype=a.extend(true,h,{namespace:f,widgetName:e,widgetEventPrefix:a[f][e].prototype.widgetEventPrefix||e,widgetBaseClass:i},d);a.omWidget.bridge(e,a[f][e])};a.omWidget.bridge=function(e,d){a.fn[e]=function(h){var f=typeof h==="string",g=Array.prototype.slice.call(arguments,1),i=this;h=!f&&g.length?a.extend.apply(null,[true,h].concat(g)):h;if(f&&h.charAt(0)==="_"){return i}if(f){this.each(function(){var j=a.data(this,e);if(h=="options"){i=j&&j.options;return false}else{var k=j&&a.isFunction(j[h])?j[h].apply(j,g):j;if(k!==j&&k!==c){i=k;return false}}})}else{this.each(function(){var j=a.data(this,e);if(j){j._setOptions(h||{});a.extend(j.options,h);a(j.beforeInitListeners).each(function(){this.call(j)});j._init();a(j.initListeners).each(function(){this.call(j)})}else{a.data(this,e,new d(h,this))}})}return i}};a.omWidget.addCreateListener=function(e,f){var d=e.split(".");a[d[0]][d[1]].prototype.createListeners.push(f)};a.omWidget.addInitListener=function(e,f){var d=e.split(".");a[d[0]][d[1]].prototype.initListeners.push(f)};a.omWidget.addBeforeInitListener=function(e,f){var d=e.split(".");a[d[0]][d[1]].prototype.beforeInitListeners.push(f)};a.OMWidget=function(d,e){this.createListeners=[];this.initListeners=[];this.beforeInitListeners=[];if(arguments.length){this._createWidget(d,e)}};a.OMWidget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(e,f){a.data(f,this.widgetName,this);this.element=a(f);this.options=a.extend(true,{},this.options,this._getCreateOptions(),e);var d=this;this.element.bind("om-remove._"+this.widgetName,function(){d.destroy()});this._create();a(this.createListeners).each(function(){this.call(d)});this._trigger("create");a(this.beforeInitListeners).each(function(){this.call(d)});this._init();a(this.initListeners).each(function(){this.call(d)})},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName)},widget:function(){return this.element},option:function(e,f){var d=e;if(arguments.length===0){return a.extend({},this.options)}if(typeof e==="string"){if(f===c){return this.options[e]}d={};d[e]=f}this._setOptions(d);return this},_setOptions:function(e){var d=this;a.each(e,function(f,g){d._setOption(f,g)});return this},_setOption:function(d,e){this.options[d]=e;return this},_trigger:function(f,g){var k=this.options[f];g=a.Event(g);g.type=f;if(g.originalEvent){for(var e=a.event.props.length,j;e;){j=a.event.props[--e];g[j]=g.originalEvent[j]}}var d=[],h=arguments.length;for(var e=2;e<h;e++){d[e-2]=arguments[e]}if(h>1){d[h-2]=arguments[1]}return !(a.isFunction(k)&&k.apply(this.element,d)===false||g.isDefaultPrevented())}}})(jQuery);(function(a,b){a.omWidget("om.omMouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var c=this;this.element.bind("mousedown."+this.widgetName,function(d){return c._mouseDown(d)}).bind("click."+this.widgetName,function(d){if(true===a.data(d.target,c.widgetName+".preventClickEvent")){a.removeData(d.target,c.widgetName+".preventClickEvent");d.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(e){e.originalEvent=e.originalEvent||{};if(e.originalEvent.mouseHandled){return}(this._mouseStarted&&this._mouseUp(e));this._mouseDownEvent=e;var d=this,f=(e.which==1),c=(typeof this.options.cancel=="string"?a(e.target).closest(this.options.cancel).length:false);if(!f||c||!this._mouseCapture(e)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)){this._mouseStarted=(this._mouseStart(e)!==false);if(!this._mouseStarted){e.preventDefault();return true}}if(true===a.data(e.target,this.widgetName+".preventClickEvent")){a.removeData(e.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(g){return d._mouseMove(g)};this._mouseUpDelegate=function(g){return d._mouseUp(g)};a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);e.preventDefault();e.originalEvent.mouseHandled=true;return true},_mouseMove:function(c){if(a.browser.msie&&!(document.documentMode>=9)&&!c.button){return this._mouseUp(c)}if(this._mouseStarted){this._mouseDrag(c);return c.preventDefault()}if(this._mouseDistanceMet(c)&&this._mouseDelayMet(c)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,c)!==false);(this._mouseStarted?this._mouseDrag(c):this._mouseUp(c))}return !this._mouseStarted},_mouseUp:function(c){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(c.target==this._mouseDownEvent.target){a.data(c.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(c)}return false},_mouseDistanceMet:function(c){return(Math.max(Math.abs(this._mouseDownEvent.pageX-c.pageX),Math.abs(this._mouseDownEvent.pageY-c.pageY))>=this.options.distance)},_mouseDelayMet:function(c){return this.mouseDelayMet},_mouseStart:function(c){},_mouseDrag:function(c){},_mouseStop:function(c){},_mouseCapture:function(c){return true}})})(jQuery);(function(c,d){c.omWidget("om.omResizable",c.om.omMouse,{widgetEventPrefix:"resize",options:{alsoResize:false,aspectRatio:false,autoHide:false,containment:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){var f=this,k=this.options;this.element.addClass("om-resizable");c.extend(this,{_aspectRatio:!!(k.aspectRatio),aspectRatio:k.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:k.helper||k.ghost||k.animate?k.helper||"om-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){if(/relative/.test(this.element.css("position"))&&c.browser.opera){this.element.css({position:"relative",top:"auto",left:"auto"})}this.element.wrap(c('<div class="om-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=k.handles||(!c(".om-resizable-handle",this.element).length?"e,s,se":{n:".om-resizable-n",e:".om-resizable-e",s:".om-resizable-s",w:".om-resizable-w",se:".om-resizable-se",sw:".om-resizable-sw",ne:".om-resizable-ne",nw:".om-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all"){this.handles="n,e,s,w,se,sw,ne,nw"}var l=this.handles.split(",");this.handles={};for(var g=0;g<l.length;g++){var j=c.trim(l[g]),e="om-resizable-"+j;var h=c('<div class="om-resizable-handle '+e+'"></div>');if(/sw|se|ne|nw/.test(j)){h.css({zIndex:++k.zIndex})}if("se"==j){h.addClass("om-icon om-icon-gripsmall-diagonal-se")}this.handles[j]=".om-resizable-"+j;this.element.append(h)}}this._renderAxis=function(q){q=q||this.element;for(var n in this.handles){if(this.handles[n].constructor==String){this.handles[n]=c(this.handles[n],this.element).show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var o=c(this.handles[n],this.element),p=0;p=/sw|ne|nw|se|n|s/.test(n)?o.outerHeight():o.outerWidth();var m=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join("");q.css(m,p);this._proportionallyResize()}if(!c(this.handles[n]).length){continue}}};this._renderAxis(this.element);this._handles=c(".om-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!f.resizing){if(this.className){var i=this.className.match(/om-resizable-(se|sw|ne|nw|n|e|s|w)/i)}f.axis=i&&i[1]?i[1]:"se"}});if(k.autoHide){this._handles.hide();c(this.element).addClass("om-resizable-autohide").hover(function(){if(k.disabled){return}c(this).removeClass("om-resizable-autohide");f._handles.show()},function(){if(k.disabled){return}if(!f.resizing){c(this).addClass("om-resizable-autohide");f._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var e=function(g){c(g).removeClass("om-resizable om-resizable-disabled om-resizable-resizing").removeData("resizable").unbind(".resizable").find(".om-resizable-handle").remove()};if(this.elementIsWrapper){e(this.element);var f=this.element;f.after(this.originalElement.css({position:f.css("position"),width:f.outerWidth(),height:f.outerHeight(),top:f.css("top"),left:f.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);e(this.originalElement);return this},_mouseCapture:function(f){var g=false;for(var e in this.handles){if(c(this.handles[e])[0]==f.target){g=true}}return !this.options.disabled&&g},_mouseStart:function(g){var j=this.options,f=this.element.position(),e=this.element;this.resizing=true;this.documentScroll={top:c(document).scrollTop(),left:c(document).scrollLeft()};if(e.is(".ui-draggable")||(/absolute/).test(e.css("position"))){e.css({position:"absolute",top:f.top,left:f.left})}if(c.browser.opera&&(/relative/).test(e.css("position"))){e.css({position:"relative",top:"auto",left:"auto"})}this._renderProxy();var k=b(this.helper.css("left")),h=b(this.helper.css("top"));if(j.containment){k+=c(j.containment).scrollLeft()||0;h+=c(j.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:k,top:h};this.size=this._helper?{width:e.outerWidth(),height:e.outerHeight()}:{width:e.width(),height:e.height()};this.originalSize=this._helper?{width:e.outerWidth(),height:e.outerHeight()}:{width:e.width(),height:e.height()};this.originalPosition={left:k,top:h};this.sizeDiff={width:e.outerWidth()-e.width(),height:e.outerHeight()-e.height()};this.originalMousePosition={left:g.pageX,top:g.pageY};this.aspectRatio=(typeof j.aspectRatio=="number")?j.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);var i=c(".om-resizable-"+this.axis).css("cursor");c("body").css("cursor",i=="auto"?this.axis+"-resize":i);e.addClass("om-resizable-resizing");this._propagate("start",g);return true},_mouseDrag:function(e){var h=this.helper,g=this.options,m={},q=this,j=this.originalMousePosition,n=this.axis;var r=(e.pageX-j.left)||0,p=(e.pageY-j.top)||0;var i=this._change[n];if(!i){return false}var l=i.apply(this,[e,r,p]),k=c.browser.msie&&c.browser.version<7,f=this.sizeDiff;this._updateVirtualBoundaries(e.shiftKey);if(this._aspectRatio||e.shiftKey){l=this._updateRatio(l,e)}l=this._respectSize(l,e);this._propagate("resize",e);h.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}this._updateCache(l);this._trigger("resize",e,this.ui());return false},_mouseStop:function(h){this.resizing=false;var i=this.options,m=this;if(this._helper){var g=this._proportionallyResizeElements,e=g.length&&(/textarea/i).test(g[0].nodeName),f=e&&m._hasScroll(g[0],"left")?0:m.sizeDiff.height,k=e?0:m.sizeDiff.width;var n={width:(m.helper.width()-k),height:(m.helper.height()-f)},j=(parseInt(m.element.css("left"),10)+(m.position.left-m.originalPosition.left))||null,l=(parseInt(m.element.css("top"),10)+(m.position.top-m.originalPosition.top))||null;if(!i.animate){this.element.css(c.extend(n,{top:l,left:j}))}m.helper.height(m.size.height);m.helper.width(m.size.width);if(this._helper&&!i.animate){this._proportionallyResize()}}c("body").css("cursor","auto");this.element.removeClass("om-resizable-resizing");this._propagate("stop",h);if(this._helper){this.helper.remove()}return false},_updateVirtualBoundaries:function(g){var j=this.options,i,h,f,k,e;e={minWidth:a(j.minWidth)?j.minWidth:0,maxWidth:a(j.maxWidth)?j.maxWidth:Infinity,minHeight:a(j.minHeight)?j.minHeight:0,maxHeight:a(j.maxHeight)?j.maxHeight:Infinity};if(this._aspectRatio||g){i=e.minHeight*this.aspectRatio;f=e.minWidth/this.aspectRatio;h=e.maxHeight*this.aspectRatio;k=e.maxWidth/this.aspectRatio;if(i>e.minWidth){e.minWidth=i}if(f>e.minHeight){e.minHeight=f}if(h<e.maxWidth){e.maxWidth=h}if(k<e.maxHeight){e.maxHeight=k}}this._vBoundaries=e},_updateCache:function(e){var f=this.options;this.offset=this.helper.offset();if(a(e.left)){this.position.left=e.left}if(a(e.top)){this.position.top=e.top}if(a(e.height)){this.size.height=e.height}if(a(e.width)){this.size.width=e.width}},_updateRatio:function(h,g){var i=this.options,j=this.position,f=this.size,e=this.axis;if(a(h.height)){h.width=(h.height*this.aspectRatio)}else{if(a(h.width)){h.height=(h.width/this.aspectRatio)}}if(e=="sw"){h.left=j.left+(f.width-h.width);h.top=null}if(e=="nw"){h.top=j.top+(f.height-h.height);h.left=j.left+(f.width-h.width)}return h},_respectSize:function(l,g){var j=this.helper,i=this._vBoundaries,r=this._aspectRatio||g.shiftKey,q=this.axis,t=a(l.width)&&i.maxWidth&&(i.maxWidth<l.width),m=a(l.height)&&i.maxHeight&&(i.maxHeight<l.height),h=a(l.width)&&i.minWidth&&(i.minWidth>l.width),s=a(l.height)&&i.minHeight&&(i.minHeight>l.height);if(h){l.width=i.minWidth}if(s){l.height=i.minHeight}if(t){l.width=i.maxWidth}if(m){l.height=i.maxHeight}var f=this.originalPosition.left+this.originalSize.width,p=this.position.top+this.size.height;var k=/sw|nw|w/.test(q),e=/nw|ne|n/.test(q);if(h&&k){l.left=f-i.minWidth}if(t&&k){l.left=f-i.maxWidth}if(s&&e){l.top=p-i.minHeight}if(m&&e){l.top=p-i.maxHeight}var n=!l.width&&!l.height;if(n&&!l.left&&l.top){l.top=null}else{if(n&&!l.top&&l.left){l.left=null}}return l},_proportionallyResize:function(){var k=this.options;if(!this._proportionallyResizeElements.length){return}var g=this.helper||this.element;for(var f=0;f<this._proportionallyResizeElements.length;f++){var h=this._proportionallyResizeElements[f];if(!this.borderDif){var e=[h.css("borderTopWidth"),h.css("borderRightWidth"),h.css("borderBottomWidth"),h.css("borderLeftWidth")],j=[h.css("paddingTop"),h.css("paddingRight"),h.css("paddingBottom"),h.css("paddingLeft")];this.borderDif=c.map(e,function(l,n){var m=parseInt(l,10)||0,o=parseInt(j[n],10)||0;return m+o})}if(c.browser.msie&&!(!(c(g).is(":hidden")||c(g).parents(":hidden").length))){continue}h.css({height:(g.height()-this.borderDif[0]-this.borderDif[2])||0,width:(g.width()-this.borderDif[1]-this.borderDif[3])||0})}},_renderProxy:function(){var f=this.element,i=this.options;this.elementOffset=f.offset();if(this._helper){this.helper=this.helper||c('<div style="overflow:hidden;"></div>');var e=c.browser.msie&&c.browser.version<7,g=(e?1:0),h=(e?2:-1);this.helper.addClass(this._helper).css({width:this.element.outerWidth()+h,height:this.element.outerHeight()+h,position:"absolute",left:this.elementOffset.left-g+"px",top:this.elementOffset.top-g+"px",zIndex:++i.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(g,f,e){return{width:this.originalSize.width+f}},w:function(h,f,e){var j=this.options,g=this.originalSize,i=this.originalPosition;return{left:i.left+f,width:g.width-f}},n:function(h,f,e){var j=this.options,g=this.originalSize,i=this.originalPosition;return{top:i.top+e,height:g.height-e}},s:function(g,f,e){return{height:this.originalSize.height+e}},se:function(g,f,e){return c.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[g,f,e]))},sw:function(g,f,e){return c.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[g,f,e]))},ne:function(g,f,e){return c.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[g,f,e]))},nw:function(g,f,e){return c.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[g,f,e]))}},_propagate:function(f,e){c.om.plugin.call(this,f,[e,this.ui()]);(f!="resize"&&this._trigger(f,e,this.ui()))},_hasScroll:function(h,f){if(c(h).css("overflow")==="hidden"){return false}var e=(f&&f==="left")?"scrollLeft":"scrollTop",g=false;if(h[e]>0){return true}h[e]=1;g=(h[e]>0);h[e]=0;return g},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});c.extend(c.om.resizable,{version:"1.1"});c.om.plugin.add("omResizable","alsoResize",{start:function(f,g){var e=c(this).data("omResizable"),i=e.options;var h=function(j){c(j).each(function(){var k=c(this);k.data("resizable-alsoresize",{width:parseInt(k.width(),10),height:parseInt(k.height(),10),left:parseInt(k.css("left"),10),top:parseInt(k.css("top"),10),position:k.css("position")})})};if(typeof(i.alsoResize)=="object"&&!i.alsoResize.parentNode){if(i.alsoResize.length){i.alsoResize=i.alsoResize[0];h(i.alsoResize)}else{c.each(i.alsoResize,function(j){h(j)})}}else{h(i.alsoResize)}},resize:function(g,i){var f=c(this).data("omResizable"),j=f.options,h=f.originalSize,l=f.originalPosition;var k={height:(f.size.height-h.height)||0,width:(f.size.width-h.width)||0,top:(f.position.top-l.top)||0,left:(f.position.left-l.left)||0},e=function(m,n){c(m).each(function(){var q=c(this),r=c(this).data("resizable-alsoresize"),p={},o=n&&n.length?n:q.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];c.each(o,function(s,u){var t=(r[u]||0)+(k[u]||0);if(t&&t>=0){p[u]=t||null}});if(c.browser.opera&&/relative/.test(q.css("position"))){f._revertToRelativePosition=true;q.css({position:"absolute",top:"auto",left:"auto"})}q.css(p)})};if(typeof(j.alsoResize)=="object"&&!j.alsoResize.nodeType){c.each(j.alsoResize,function(m,n){e(m,n)})}else{e(j.alsoResize)}},stop:function(g,h){var f=c(this).data("omResizable"),i=f.options;var e=function(j){c(j).each(function(){var k=c(this);k.css({position:k.data("resizable-alsoresize").position})})};if(f._revertToRelativePosition){f._revertToRelativePosition=false;if(typeof(i.alsoResize)=="object"&&!i.alsoResize.nodeType){c.each(i.alsoResize,function(j){e(j)})}else{e(i.alsoResize)}}c(this).removeData("resizable-alsoresize")}});c.om.plugin.add("omResizable","containment",{start:function(f,r){var t=c(this).data("omResizable"),j=t.options,l=t.element;var g=j.containment,k=(g instanceof c)?g.get(0):(/parent/.test(g))?l.parent().get(0):g;if(!k){return}t.containerElement=c(k);if(/document/.test(g)||g==document){t.containerOffset={left:0,top:0};t.containerPosition={left:0,top:0};t.parentData={element:c(document),left:0,top:0,width:c(document).width(),height:c(document).height()||document.body.parentNode.scrollHeight}}else{var n=c(k),i=[];c(["Top","Right","Left","Bottom"]).each(function(p,o){i[p]=b(n.css("padding"+o))});t.containerOffset=n.offset();t.containerPosition=n.position();t.containerSize={height:(n.innerHeight()-i[3]),width:(n.innerWidth()-i[1])};var q=t.containerOffset,e=t.containerSize.height,m=t.containerSize.width,h=(t._hasScroll(k,"left")?k.scrollWidth:m),s=(t._hasScroll(k)?k.scrollHeight:e);t.parentData={element:k,left:q.left,top:q.top,width:h,height:s}}},resize:function(g,q){var t=c(this).data("omResizable"),i=t.options,f=t.containerSize,p=t.containerOffset,m=t.size,n=t.position,r=t._aspectRatio||g.shiftKey,e={top:0,left:0},h=t.containerElement;if(h[0]!=document&&(/static/).test(h.css("position"))){e=p}if(n.left<(t._helper?p.left:0)){t.size.width=t.size.width+(t._helper?(t.position.left-p.left):(t.position.left-e.left));if(r){t.size.height=t.size.width/i.aspectRatio}t.position.left=i.helper?p.left:0}if(n.top<(t._helper?p.top:0)){t.size.height=t.size.height+(t._helper?(t.position.top-p.top):t.position.top);if(r){t.size.width=t.size.height*i.aspectRatio}t.position.top=t._helper?p.top:0}t.offset.left=t.parentData.left+t.position.left;t.offset.top=t.parentData.top+t.position.top;var l=Math.abs((t._helper?t.offset.left-e.left:(t.offset.left-e.left))+t.sizeDiff.width),s=Math.abs((t._helper?t.offset.top-e.top:(t.offset.top-p.top))+t.sizeDiff.height);var k=t.containerElement.get(0)==t.element.parent().get(0),j=/relative|absolute/.test(t.containerElement.css("position"));if(k&&j){l-=t.parentData.left}if(l+t.size.width>=t.parentData.width){t.size.width=t.parentData.width-l;if(r){t.size.height=t.size.width/t.aspectRatio}}if(s+t.size.height>=t.parentData.height){t.size.height=t.parentData.height-s;if(r){t.size.width=t.size.height*t.aspectRatio}}},stop:function(f,n){var q=c(this).data("omResizable"),g=q.options,l=q.position,m=q.containerOffset,e=q.containerPosition,i=q.containerElement;var j=c(q.helper),r=j.offset(),p=j.outerWidth()-q.sizeDiff.width,k=j.outerHeight()-q.sizeDiff.height;if(q._helper&&!g.animate&&(/relative/).test(i.css("position"))){c(this).css({left:r.left-e.left-m.left,width:p,height:k})}if(q._helper&&!g.animate&&(/static/).test(i.css("position"))){c(this).css({left:r.left-e.left-m.left,width:p,height:k})}}});var b=function(e){return parseInt(e,10)||0};var a=function(e){return !isNaN(parseInt(e,10))}})(jQuery);(function(a){a.omWidget("om.omGrid",{options:{height:462,width:"100%",colModel:false,autoFit:false,showIndex:true,dataSource:false,extraData:{},method:"GET",preProcess:false,limit:15,rowClasses:["oddRow","evenRow"],singleSelect:true,title:"",onRowSelect:function(d,c,b){},onRowDeselect:function(d,c,b){},onRowClick:function(d,c,b){},onRowDblClick:function(d,c,b){},onPageChange:function(c,b,d){},onSuccess:function(e,b,d,c){},onError:function(c,e,d,b){},onRefresh:function(d,b,c){},_onRefreshCallbacks:[],_onResizableStopCallbacks:[],_onResizableCallbacks:[],_onResizeCallbacks:[]},_create:function(){var b=this.options,d=this.element.show().attr({cellPadding:0,cellSpacing:0,border:0}).empty().append("<tbody></tbody>");d.wrap('<div class="om-grid om-widget om-widget-content"><div class="bDiv" style="width:100%"></div></div>').closest(".om-grid");if(!a.isArray(this._getColModel())){return}this.hDiv=a('<div class="hDiv om-state-default"></div>').append('<div class="hDivBox"><table cellPadding="0" cellSpacing="0"></table></div>');d.parent().before(this.hDiv);this.pDiv=a('<div class="pDiv om-state-default"></div>');d.parent().after(this.pDiv);var c=d.closest(".om-grid");this.loadMask=a('<div class="gBlock"><div align="center" class="gBlock-valignMiddle" ><div class="loadingImg" style="display:block"/></div></div>').mousedown(function(f){return false}).hide();c.append(this.loadMask);this.titleDiv=a("<div class='titleDiv'></div>");c.prepend(this.titleDiv);this.tbody=this.element.children().eq(0);this._guid=0;b._onRefreshCallbacks.push(function(){this._refreshHeaderCheckBox()});this._bindScrollEnvent()},_init:function(){var c=this.element,d=this.options,b=c.closest(".om-grid");this._measure(b,d);if(!a.isArray(this._getColModel())){return}this._extraData={};this.tbody.empty();a("table",this.hDiv).empty();this.pDiv.empty();this.titleDiv.empty();this._buildTableHead();this._buildPagingToolBar();this._buildLoadMask();this._bindSelectAndClickEnvent();this._makeColsResizable();this._buildTitle();this._resetHeight();this.pageData={nowPage:1,totalPages:1};this._populate()},resize:function(d){var e=this,g=this.options,c=this.element.closest(".om-grid"),f,b;d=d||{};g.width=d.width||arguments[0]||g.width;g.height=d.height||arguments[1]||g.height;this._measure(c,g);this._buildLoadMask();this._resetWidth();this._resetHeight();a.each(g._onResizeCallbacks,function(h,i){i.call(e)})},_measure:function(b,c){b.outerWidth(c.width==="fit"?b.parent().width():c.width);b.outerHeight(c.height==="fit"?b.parent().height():c.height)},_resetHeight:function(){var e=this.element,b=e.closest(".om-grid");var c=this.hDiv.outerHeight(true),d=this.pDiv.is(":hidden")?0:this.pDiv.outerHeight(true),f=this.titleDiv.is(":hidden")?0:this.titleDiv.outerHeight(true);b.children(".bDiv").outerHeight(b.height()-c-d-f)},_resetWidth:function(){var g=this.options,e=this._getColModel(),c=-1,b=this.element.closest(".om-grid"),f=a("thead",this.hDiv),h=0;a.each(e,function(j,i){var k=i.width||60;if(i.width=="autoExpand"){k=0;c=j}f.find("th[axis='col"+j+"'] >div").width(k);h+=k});this._fixHeaderWidth(c,h);var d={};a(this._getHeaderCols()).each(function(){d[a(this).attr("abbr")]=a("div",a(this)).width()});this.tbody.find("td[abbr]").each(function(j,k){var i=a(k).prop("abbr");if(d[i]!=null){a(k).find(">div:first").width(d[i])}})},_getColModel:function(){return this.options.colModel},_buildTitle:function(){var b=this.titleDiv;if(this.options.title){b.html("<div class='titleContent'>"+this.options.title+"</div>").show()}else{b.empty().hide()}},_fixHeaderWidth:function(c,k){var l=this.element.closest(".om-grid"),i=a("thead",this.hDiv),j=this._getColModel(),d=this.options;if(c!=-1){var g=l.width()-32,e=i.find('th[axis="col'+c+'"] div');e.parent().hide();var f=g-i.width();e.parent().show();if(f<=0){e.css("width",60)}else{e.css("width",f)}}else{if(d.autoFit){var g=l.width()-22,f=g-i.width(),h=1+f/k,b=i.find('th[axis^="col"] >div');a.each(j,function(m){var n=b.eq(m);n.width(parseInt(n.width()*h))})}}},_buildTableHead:function(){var j=this.options,f=this.element,b=f.closest(".om-grid"),m=this._getColModel(),p=0,g=0,r=0,d=-1;thead=a("<thead></thead>");tr=a("<tr></tr>").appendTo(thead);if(j.showIndex){var q=a("<th></th>").attr({axis:"indexCol",align:"center"}).addClass("indexCol").append(a('<div class="indexheader" style="text-align:center;width:60px;"></div>'));tr.append(q);g=25}if(!j.singleSelect){var q=a("<th></th>").attr({axis:"checkboxCol",align:"center"}).addClass("checkboxCol").append(a('<div class="checkboxheader" style="text-align:center;width:17px;"><span class="checkbox"/></div>'));tr.append(q);r=17}for(var h=0,l=m.length;h<l;h++){var o=m[h],c=o.width||60,k=o.align||"center";if(c=="autoExpand"){c=0;d=h}var n=a("<div></div>").html(o.header).css({"text-align":k,width:c});o.wrap&&n.addClass("wrap");var e=a("<th></th>").attr("axis","col"+h).addClass("col"+h).append(n);if(o.name){e.attr("abbr",o.name)}if(o.align){e.attr("align",o.align)}p+=c;tr.append(e)}f.prepend(thead);a("table",this.hDiv).append(thead);this._fixHeaderWidth(d,p);this.thead=thead;thead=null},_buildPagingToolBar:function(){var f=this.options;if(f.limit<=0){this.pDiv.css("border-width",0).hide();this.pager=this.pDiv;return}var c=this,d=this.element,b=this.pDiv;b.show().html('<div class="pDiv2"><div class="pGroup"><div class="pFirst pButton om-icon"><span class="om-icon-seek-start"></span></div><div class="pPrev pButton om-icon"><span class="om-icon-seek-prev"></span></div></div><div class="btnseparator"></div><div class="pGroup"><span class="pControl"></span></div><div class="btnseparator"></div><div class="pGroup"><div class="pNext pButton om-icon"><span class="om-icon-seek-next"></span></div><div class="pLast pButton om-icon"><span class="om-icon-seek-end"></span></div></div><div class="btnseparator"></div><div class="pGroup"><div class="pReload pButton om-icon"><span class="om-icon-refresh"></span></div></div><div class="btnseparator"></div><div class="pGroup"><span class="pPageStat"></span></div></div>');var e=a.om.lang._get(f,"omGrid","pageText").replace(/{totalPage}/,"<span>1</span>").replace(/{index}/,'<input type="text" size="4" value="1" />');a(".pControl",b).html(e);d.parent().after(b);a(".pReload",b).click(function(){c._populate()});a(".pFirst",b).click(function(){c._changePage("first")});a(".pPrev",b).click(function(){c._changePage("prev")});a(".pNext",b).click(function(){c._changePage("next")});a(".pLast",b).click(function(){c._changePage("last")});a(".pControl input",b).keydown(function(g){if(g.keyCode==a.om.keyCode.ENTER){c._changePage("input")}});a(".pButton",b).hover(function(){a(this).addClass("om-state-hover")},function(){a(this).removeClass("om-state-hover")});this.pager=b},_buildLoadMask:function(){var b=this.element.closest(".om-grid");this.loadMask.css({width:"100%",height:b.height()})},_changePage:function(c){if(this.loading){return true}var e=this.element,h=this.options,b=e.closest(".om-grid"),d=this.pageData,g=d.nowPage,i=d.totalPages,f=g;this._oldPage=g;switch(c){case"first":f=1;break;case"prev":if(g>1){f=g-1}break;case"next":if(g<i){f=g+1}break;case"last":f=i;break;case"input":var j=parseInt(a(".pControl input",e.closest(".om-grid")).val());if(isNaN(j)){j=g}if(j<1){j=1}else{if(j>i){j=i}}a(".pControl input",this.pDiv).val(j);f=j;break;default:if(/\d/.test(c)){var j=parseInt(c);if(isNaN(j)){j=1}if(j<1){j=1}else{if(j>i){j=i}}a(".pControl input",e.closest(".om-grid")).val(j);f=j}}if(f==g){return false}if(this._trigger("onPageChange",null,c,f)===false){return}d.nowPage=f;this._populate()},_populate:function(){var k=this,f=this.element,b=f.closest(".om-grid"),j=this.options,e=a(".pPageStat",b);if(!j.dataSource){a(".pPageStat",b).html(j.emptygMsg);return false}if(this.loading){return true}var d=this.pageData,h=d.nowPage||1,c=a(".gBlock",b);this.loading=true;e.html(a.om.lang._get(j,"omGrid","loadingMsg"));c.show();var i=(j.limit<=0)?100000000:j.limit;var g=a.extend(true,{},this._extraData,j.extraData,{start:i*(h-1),limit:i,_time_stamp_:new Date().getTime()});a.ajax({type:j.method,url:j.dataSource,data:g,dataType:"json",success:function(o,q,n){var p=j.onSuccess;if(typeof(p)=="function"){k._trigger("onSuccess",null,o,q,n)}k._addData(o);for(var m=0,l=j._onRefreshCallbacks.length;m<l;m++){j._onRefreshCallbacks[m].call(k)}k._trigger("onRefresh",null,h,o.rows);c.hide();k.loading=false},error:function(m,p,o){e.html(a.om.lang._get(j,"omGrid","errorMsg")).css("color","red");try{var l=j.onError;if(typeof(l)=="function"){l(m,p,o)}}catch(n){}finally{c.hide();k.loading=false;k.pageData.data={rows:[],total:0};return false}}})},_addData:function(g){var h=this.options,f=this.element,e=f.closest(".om-grid"),b=a(".pPageStat",e),d=h.preProcess,c=this.pageData;d&&(g=d(g));c.data=g;c.totalPages=Math.ceil(g.total/h.limit);this._buildPager();this._renderDatas()},_buildPager:function(){var i=this.options;if(i.limit<=0){return}var e=this.element,g=this.pager,b=a(".pControl",g),d=this.pageData,f=d.nowPage,j=d.totalPages,h=d.data,l=i.limit*(f-1)+1,k=l-1+h.rows.length,c="";if(h.total===0){c=a.om.lang._get(i,"omGrid","emptyMsg")}else{c=a.om.lang._get(i,"omGrid","pageStat").replace(/{from}/,l).replace(/{to}/,k).replace(/{total}/,h.total)}a("input",b).val(f);a("span",b).html(j);a(".pPageStat",g).html(c)},_renderDatas:function(){var r=this,f=this.element,l=this.options,c=f.closest(".om-grid"),n=this._getHeaderCols(),s=this.pageData.data.rows||[],o=this._getColModel(),h=l.rowClasses,k=a("tbody",f).empty(),b=(typeof h==="function"),e=this.pageData,d=(e.nowPage-1)*l.limit,g="<td align='$' abbr='$' class='$'><div align='$' class='innerCol $' style='width:$px'>$</div></td>",q=[],p=[],m,i;if(!this.pageData.data.rows){this.pageData.data.rows=[]}r.hDiv.scrollLeft(0);a(n).each(function(j){q[j]=a("div",a(this)).width()});a.each(s,function(j,u){var t=b?h(j,u):h[j%h.length];var v=r._buildRowCellValues(o,u,j);p.push("<tr _grid_row_id="+(r._guid++)+" class='om-grid-row "+t+"'>");a(n).each(function(x){var A=a(this).attr("axis"),z=false,y;if(A=="indexCol"){y=j+d+1}else{if(A=="checkboxCol"){y='<span class="checkbox"/>'}else{if(A.substring(0,3)=="col"){var w=A.substring(3);y=v[w];if(o[w].wrap){z=true}}else{y=""}}}m=[this.align,this.abbr,A,this.align,z?"wrap":"",q[x],y];i=0;p.push(g.replace(/\$/g,function(){return m[i++]}))});p.push("</tr>")});k.html(p.join(" "))},_getHeaderCols:function(){return this.hDiv.find("th[axis]")},_buildRowCellValues:function(n,e,m){var h=n.length,o=[];for(var g=0;g<h;g++){var l=n[g],p,b=l.renderer;if(l.name.indexOf(".")>0){var k=l.name.split("."),f=1,d=k.length,p=e[k[0]];while(f<d&&p&&(p=p[k[f++]])!=undefined){}}if(p==undefined){p=e[l.name]==undefined?"":e[l.name]}if(typeof b==="function"){p=b(p,e,m)}o[g]=p;p=null}return o},_bindScrollEnvent:function(){var b=this;this.tbody.closest(".bDiv").scroll(function(){b.hDiv.scrollLeft(a(this).scrollLeft())})},_bindSelectAndClickEnvent:function(){var b=this;this.tbody.unbind();if(!this.options.singleSelect){a("th.checkboxCol span.checkbox",this.thead).click(function(){var e=a(this),d=b._getTrs().size();if(e.hasClass("selected")){e.removeClass("selected");for(var c=0;c<d;c++){b._rowDeSelect(c)}}else{e.addClass("selected");for(var c=0;c<d;c++){b._rowSelect(c)}}});this.tbody.delegate("tr.om-grid-row","click",function(d){var e=a(this),c=b._getRowIndex(e);if(e.hasClass("om-state-highlight")){b._rowDeSelect(c)}else{b._rowSelect(c)}b._refreshHeaderCheckBox();b._trigger("onRowClick",d,c,b._getRowData(c))});this.tbody.delegate("tr.om-grid-row","dblclick",function(d){var e=a(this),c=b._getRowIndex(e);if(e.hasClass("om-state-highlight")){}else{b._rowSelect(c);b._refreshHeaderCheckBox()}b._trigger("onRowDblClick",d,c,b._getRowData(c))})}else{this.tbody.delegate("tr.om-grid-row","click",function(d){var f=a(this),c=b._getRowIndex(f);if(f.hasClass("om-state-highlight")){}else{var e=b._getRowIndex(b.tbody.find("tr.om-state-highlight:not(:hidden)"));(e!=-1)&&b._rowDeSelect(e);b._rowSelect(c)}b._trigger("onRowClick",d,c,b._getRowData(c))});this.tbody.delegate("tr.om-grid-row","dblclick",function(d){var c=b._getRowIndex(this);b._trigger("onRowDblClick",d,c,b._getRowData(c))})}},_getRowData:function(b){return this.pageData.data.rows[b]},_rowSelect:function(d){var e=this.element,g=this.options,c=a("tbody",e),f=this._getTrs().eq(d),b=a("td.checkboxCol span.checkbox",f);f.addClass("om-state-highlight");b.addClass("selected");this._trigger("onRowSelect",null,d,this._getRowData(d))},_rowDeSelect:function(d){var e=this.element,g=this.options,c=a("tbody",e),f=this._getTrs().eq(d),b=a("td.checkboxCol span.checkbox",f);f.removeClass("om-state-highlight");b.removeClass("selected");this._trigger("onRowDeselect",null,d,this._getRowData(d))},_refreshHeaderCheckBox:function(){var e=this.getSelections(),d=this._getTrs(),c=a("th.checkboxCol span.checkbox",this.thead),b=d.length;c.toggleClass("selected",b>0&&b==e.length)},_makeColsResizable:function(){var b=this,e=b.tbody.closest(".bDiv"),d=b.element.closest(".om-grid"),c=this.titleDiv,f;a('th[axis^="col"] div',b.thead).omResizable({handles:"e",containment:"document",minWidth:60,resize:function(n,g){var m=b.options._onResizableCallbacks;for(var j=0,l=m.length;j<l;j++){m[j].call(b)}var k=a(this),o=k.parent().attr("abbr"),h=a('td[abbr="'+o+'"] > div',b.tbody),p=b.thead.closest(".hDiv");k.width(n.size.width).height("");h.width(n.size.width).height("");e.height(d.height()-(c.is(":hidden")?0:c.outerHeight(true))-p.outerHeight(true)-(b.pDiv.is(":hidden")?0:b.pDiv.outerHeight(true)));p.scrollLeft(e.scrollLeft())},start:function(h,g){f=a(this).parent().width()},stop:function(n,m){var l=b.options._onResizableStopCallbacks,k=a(this).parent(),h=b.thead.closest(".hDiv");f=k.width()-f;for(var j=0,g=l.length;j<g;j++){l[j].call(b,k,f)}h.scrollLeft(e.scrollLeft())}})},_getRowIndex:function(b){return this._getTrs().index(b)},_getTrs:function(){return this.tbody.find("tr.om-grid-row:not([_delete]=true)")},setData:function(b){this.options.dataSource=b;this.pageData={nowPage:1,totalPages:1};this._populate()},getData:function(){return this.pageData.data},refresh:function(){if(this.loading){return true}this.loading=true;var d=this.options;a(".pPageStat",this.pager).html(a.om.lang._get(d,"omGrid","loadingMsg"));this.loadMask.show();this._buildPager();this._renderDatas();this._trigger("onRefresh",null,this.pageData.nowPage||1,this.pageData.data.rows);for(var c=0,b=d._onRefreshCallbacks.length;c<b;c++){d._onRefreshCallbacks[c].call(this)}this.loadMask.hide();this.loading=false},reload:function(b){if(this.loading){return true}if(typeof b!=="undefined"){b=parseInt(b)||1;if(b<0){b=1}if(b>this.pageData.totalPages){b=this.pageData.totalPages}this.pageData.nowPage=b}this._populate()},setSelections:function(c){var b=this;if(!a.isArray(c)){c=[c]}var d=this.getSelections();a(d).each(function(){b._rowDeSelect(this)});a(c).each(function(){b._rowSelect(this)});b._refreshHeaderCheckBox()},getSelections:function(c){var f=this,e=f._getTrs(),g=e.filter(".om-state-highlight"),b=[];if(c){var d=f.getData().rows;g.each(function(h,i){b[b.length]=d[e.index(i)]})}else{g.each(function(h,i){b[b.length]=e.index(i)})}return b},destroy:function(){var b=this.element;b.closest(".om-grid").after(b).remove()}});a.om.lang.omGrid={loadingMsg:"正在加载数据，请稍候...",emptyMsg:"没有数据",errorMsg:"取数出错",pageText:"第{index}页，共{totalPage}页",pageStat:"共{total}条数据，显示{from}-{to}条"}})(jQuery);(function(b){var a=[{cls:"pFirst",type:"first"},{cls:"pPrev",type:"prev"},{cls:"pNext",type:"next"},{cls:"pLast",type:"last"},{cls:"pReload",type:"reload"}];function c(d,e){var g=d._oldPage,f=d.pageData.nowPage;if("input"===e){return g!=b(".pControl input",d.element.closest(".om-grid")).val()}else{if("reload"===e){return true}else{return g!=f}}}b.omWidget.addInitListener("om.omGrid",function(){var f=this,e=this._getColModel(),h=this._getHeaderCols().filter("[axis^='col']"),j=this.pDiv;b(h).each(function(i){var k=e[i].sort;if(k){var l=b(this).click(function(){var o=e[i].name;var q=l.hasClass("asc")?"asc":l.hasClass("desc")?"desc":null;var n=(q=="asc"?"desc":"asc");h.removeClass("asc desc");l.addClass(n);var p=f._extraData;delete p.sortBy;delete p.sortDir;switch(k){case"serverSide":p.sortBy=o;p.sortDir=n;f.reload();return;case"clientSide":k=function(t,r){var u=t[o],s=r[o];return u==s?0:u>s?1:-1};break;default:}var m=f.pageData.data;if(q==null){m.rows=m.rows.sort(k)}else{m.rows=m.rows.reverse()}f.refresh()});l.children().first().append('<img class="om-grid-sortIcon" src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="></img>')}});for(var g=0,d=a.length;g<d;g++){(function(k){j.find("."+a[k].cls).click(function(){var i=c(f,a[k].type);h.each(function(l){var m=b(this);if(i&&(m.hasClass("asc")||m.hasClass("desc"))&&"serverSide"!==e[l].sort){m.removeClass("asc desc")}})})})(g)}b(".pControl input",j).keydown(function(i){var k=c(f,"input");if(i.keyCode==b.om.keyCode.ENTER){h.each(function(l){var m=b(this);if(k&&(m.hasClass("asc")||m.hasClass("desc"))&&"serverSide"!==e[l].sort){m.removeClass("asc desc")}})}});this.clearSort=function(){var i=this._extraData;i.sortBy=undefined;i.sortDir=undefined;this._getHeaderCols().removeClass("asc desc")}})})(jQuery);(function(b){b.omWidget.addInitListener("om.omGrid",function(){var l=this,e=this.options,d=e.rowDetailsProvider,j=e.colModel,h=this.thead;if(!(d&&j.length>0)){return}e._onResizableCallbacks.push(a);e._onResizableStopCallbacks.push(a);h.find("th:first").before('<th align="center" axis="expenderCol" class="expenderCol" rowspan='+(b.isArray(j[0])?j.length:1)+'><div style="text-align: center; width: 14px;"></div></th>');var c=-1,i=0;j=this._getColModel();b(j).each(function(m){if(j[m].width=="autoExpand"){c=m}else{i+=j[m].width}});var f=h.find('th[axis="expenderCol"]').width();if(c!=-1){h.find('th[axis="col'+c+'"] >div').css("width","-="+f)}else{if(e.autoFit){var g=f/i;h.find('th[axis^="col"] >div').each(function(m){b(this).css("width","-="+parseInt(j[m].width*g))})}}var k=this._getHeaderCols().size();this.tbody.delegate("td.expenderCol >div","click",function(o){var q=b(this),m=q.closest("tr"),n=m.next("tr");if(n.hasClass("rowExpand-rowDetails")){n.toggle()}else{var p=l._getTrs().index(m);rowData=l._getRowData(p),rowDetails=d?d(rowData,p):"&#160;";m.after('<tr class="rowExpand-rowDetails"><td colspan="'+(k-1)+'"><div class="rowExpand-rowDetails-content">'+rowDetails+"</div></td></tr>")}q.toggleClass("rowExpand-expanded").parent().attr("rowspan",q.hasClass("rowExpand-expanded")?2:1);a.call(l);return false})});function a(){var c=this.element;var f=c.find("tr.rowExpand-rowDetails");if(f.length==0){return}var d=this.hDiv.find("table");var e=d.width()-d.find("th.expenderCol").outerWidth()-parseInt(f.find("> td").css("border-right-width"));f.each(function(){b(this).find(".rowExpand-rowDetails-content").outerWidth(e)})}})(jQuery);(function(d){var l=Object.prototype.hasOwnProperty;d.omWidget.addInitListener("om.omGrid",function(){var A=this,z=A.element,C=A.options,x=this._getColModel();A._triggered=false;A._globalEditable=false;C.editMode=C.editMode||"all";A._allEditMode=C.editMode=="all";for(var B=0,w=x.length;B<w;B++){A._globalEditable=x[B]["editor"]?true:false;if(A._globalEditable){break}}if(!i(A)){return}A._editComps={};A._errorHolders={};A._colWidthResize;C._onRefreshCallbacks.push(t);C._onResizableStopCallbacks.push(k);C._onResizeCallbacks.push(j);this.tbody.delegate("tr.om-grid-row","dblclick",function(D){b.call(this,A)});this.tbody.delegate("tr.om-grid-row","click",function(D){if(A._triggered&&A._editView.editing){if(A._validator){A._validator.valid()&&b.call(this,A)}else{b.call(this,A)}}});var y;z.parent().scroll(function(){if(A._triggered){if(y){clearTimeout(y)}y=setTimeout(function(){var D=v(A);A._editView.editBtn.animate({left:D.left,top:D.top},A._editView.editing?"fast":0);y=null},300)}});d.extend(this,{cancelEdit:function(F){var E=this._editView,D=this.options;if(!i(this)||!this._triggered||(this._triggered&&!E.editing)){return}E.view.hide();E.editing=false;if(this._rowAdding){this.deleteRow(this._getTrs().index(this.tbody.find("tr[_grid_row_id='"+A._editView.rowId+"']")));this._rowAdding=false}s(this);F&&d(F).blur();D.onCancelEdit&&D.onCancelEdit.call(this)},cancelChanges:function(){this.cancelEdit();if(f(this)){return}g(this);s(this);this.refresh()},editRow:function(D){if(!i(this)){return}b.call(this._getTrs().eq(D)[0],this)},deleteRow:function(F){if(!i(this)||(this._triggered&&this._editView.editing)){return}var E=this._getTrs(),D=this;if(!d.isArray(F)){F=[F]}F.sort(function(H,G){return G-H});d(F).each(function(H,J){var I=E.eq(J),G=I.next(),K=a(I);if(I.attr("_insert")){delete D._changeData.insert[K];I.remove();if(G.hasClass("rowExpand-rowDetails")){G.remove()}}else{D._changeData["delete"][K]=D._rowIdDataMap[K];I.attr("_delete","true").hide();if(G.hasClass("rowExpand-rowDetails")){G.hide()}}});this._refreshHeaderCheckBox()},getChanges:function(H){var J={update:[],insert:[],"delete":[]},D=H?H:"update",G=this._changeData,F;if(D==="update"){var E=G[D];for(F in E){l.call(E,F)&&J[D].push(d.extend(true,{},this._rowIdDataMap[F],E[F]))}D=H?H:"insert"}if(D==="insert"){var I=G[D];for(F in I){l.call(I,F)&&J[D].push(I[F])}D=H?H:"delete"}if(D==="delete"){var K=G[D];for(F in K){l.call(K,F)&&J[D].push(K[F])}}if(H){return J[H]}else{return J}},insertRow:function(O,I,R){var F=this.options,P=this._getColModel(),E=this.element;if(!i(this)||this._rowAdding){return}if(d.isPlainObject(O)){I=O;O=0}if(O===true){I={};O=0;R=true}var G=this._getTrs(),S={};O=("begin"==O||O==undefined)?0:("end"==O?G.length:O);for(var K=0,N=P.length;K<N;K++){S[P[K]["name"]]=""}this._changeData.insert[this._guid]=d.extend(true,S,I);var Q=this._buildRowCellValues(P,S,O),D=[],H=F.rowClasses;isRowClassesFn=(typeof H==="function"),rowCls=isRowClassesFn?H(O,S):H[O%H.length],tdTmp="<td align='$' abbr='$' class='grid-cell-dirty $'><div align='$' class='$' style='width:$px'>$</div></td>";D.push("<tr class='om-grid-row "+rowCls+"' _grid_row_id="+(this._guid++)+" _insert='true'>");this._getHeaderCols().each(function(W){var Y=d(this).attr("axis"),X=false,V,Z,U;if(Y=="indexCol"){V="<a class='om-icon'>新行</a>"}else{if(Y=="checkboxCol"){V='<span class="checkbox"/>'}else{if(Y.substring(0,3)=="col"){var T=Y.substring(3);V=Q[T];if(P[T].wrap){X=true}}else{V=""}}}Z=[this.align,this.abbr,Y,this.align,X?"wrap":"",d("div",d(this)).width(),V];U=0;D.push(tdTmp.replace(/\$/g,function(){return Z[U++]}))});D.push("</tr>");var M=d(D.join(" ")),L,J;if(O==0){M.prependTo(E.find(">tbody"))}else{L=G.eq(O-1);J=L.next();L=J.hasClass("rowExpand-rowDetails")?J:L;L.after(M)}if(!R){this.editRow(O);this._rowAdding=true}},saveChanges:function(){this.cancelEdit();if(f(this)){return}var F=this._changeData.update,E=this.element.find("tr.om-grid-row"),H=[];for(var G in F){if(l.call(F,G)){d.extend(true,this._rowIdDataMap[G],F[G])}}var D=this;E.each(function(I,K){var J=d(K);if(J.attr("_delete")){J.remove()}else{H.push(u(D,K))}});this.pageData.data.rows=H;g(this);s(this);this.refresh()},onBeforeEdit:function(E,D){},onAfterEdit:function(E,D){},onCancelEdit:function(){},getData:function(){var D=this.pageData.data,F=this._getTrs(),E=this;if(i(this)&&h(this)){D={total:D.total};D.rows=[];F.each(function(G,H){D.rows.push(E._getRowData(G))})}return D},_getRowData:function(E){var G=this._getTrs().eq(E),I=a(G),H;if(f(this)){return this.pageData.data.rows[E]}if(G.attr("_insert")){H=this._changeData.insert[I]}else{var F=this._rowIdDataMap[I],D=this._changeData.update;H=F;if(D[I]){H=d.extend(true,{},F,D[I])}}return H}})});function b(H){var C=d(this),x=H.element,D,B,A,G=H._getColModel(),w,F,y=H.options;if(!i(H)){return}if(!H._allEditMode&&!C.attr("_insert")){return}if(H._triggered&&H._editView.editing&&a(C)==H._editView.rowId){return}if(H._rowAdding){return}var E=H._getTrs().index(C),z=H._getRowData(E);if(y.onBeforeEdit&&y.onBeforeEdit.call(H,E,z)===false){return}q(H,C);D=H._editView.editRow;B=D.find(">.grid-edit-form");A=x.parent().scrollLeft();H._getHeaderCols().each(function(Q){var L=d(this).attr("axis"),N,T=C.find("td:eq("+Q+")"),I,V;if(L.substring(0,3)=="col"){var U=L.substring(3);N=G[U]}else{if(d.isEmptyObject(H._editComps)){D.css("padding-left",parseInt(D.css("padding-left"))+T.outerWidth())}return}var P=N.editor;if(!H._triggered){if(!P||(P&&(P.editable===false||(d.isFunction(P.editable)&&P.editable()===false)))){var R=P&&P.renderer;N.editor=P={};P.type="text";if(R){P.renderer=R;P.type="custom"}P.editable=false}else{P.type=P.type||"text";P.editable=true;if(P.rules){H._validate=true}}V=N.editor.name||N.name;P.options=P.options||{};H._editComps[V]={}}else{V=N.editor.name||N.name}w=H._editComps[V];F=(F=n(H,C,N))==undefined?"":F;if(!H._triggered&&P.editable&&P.rules){H._errorHolders[V]=d("<div class='errorContainer' style='display:none'></div>").appendTo(x.parent())}var K=w.instance,O,S=P.type;if(!K){O=d("<div style='position:absolute'></div>").css({left:T.position().left+A,top:3}).appendTo(B).addClass("grid-edit-wrapper");K=w.instance=d("<input></input>").attr({name:V,id:V}).appendTo(O);if("text"!=S&&"custom"!=S){K[S](P.options)}if("omCalendar"==S||"omCombo"==S){var M=K.parent();if("omCalendar"==S){K.val(F).width(T.outerWidth()-24);K.width(T.outerWidth(true)-(M.outerWidth(true)-K.width()))}else{K.next("input").attr({id:K.prop("id"),name:K.prop("name")});K.attr({id:"",name:""});K.next("input").width(T.outerWidth(true)-(M.outerWidth(true)-K.next("input").width()))}}else{if("text"==S){K.addClass("grid-edit-text");if(!P.editable){K.attr("readonly","readonly").addClass("readonly-text")}}if("custom"==S){K=w.instance=O.html(P.renderer.call(H,F,z))}K.width(T.outerWidth(true)-(K.outerWidth(true)-K.width()))}w.model=N;w.type=S;w.id=N.name;if("custom"!=S){var J="omCombo"==S?K.next():K;J.blur(function(X){var W=H._errorHolders[V];W&&W.hide()})}}switch(S){case"omCalendar":K=K.val(F).omCalendar();break;case"omNumberField":K.val(F).trigger("blur");break;case"omCombo":K.omCombo("value",F);break;case"text":K.val(F);break;case"custom":K.html(P.renderer.call(H,F,z));default:}});!H._triggered&&H._validate&&p(H);H._validator&&H._validator.form();H._triggered=true}function g(w){w._changeData={update:{},insert:{},"delete":{}}}function f(w){return !i(w)||!h(w)}function v(x){var w=x.element,z=w.parent(),A=x._editView,B=A.view,y=A.editBtn,D=A.editRow,C={};C.top=D.height();if(w.width()<z.width()){C.left=w.width()/2-y.width()/2}else{C.left=z.scrollLeft()+z.width()/2-y.width()/2}return C}function t(){if(i(this)){g(this);r(this);if(this._triggered){s(this);this._editView.view.hide();this._editView.editing=false;this.hDiv.scrollLeft(0);this.element.parent().scrollLeft(0)}}}function i(w){return !w._allEditMode||w._globalEditable}function r(x){var w=x.getData().rows;x._rowIdDataMap={};x._getTrs().each(function(y,z){x._rowIdDataMap[a(z)]=w[y]})}function s(w){if(w._validator){w._validator.resetForm();d.each(w._errorHolders,function(x,y){y.empty().hide()})}}function h(x){var w=x._changeData;return !(d.isEmptyObject(w.update)&&d.isEmptyObject(w.insert)&&d.isEmptyObject(w["delete"]))}function q(H,D){var w=H.element,G=w.next(".grid-edit-view"),F,C,A=d(D).position(),y=w.parent().scrollTop(),x=H.options;if(G.length==0){G=d("<div class='grid-edit-view'><div class='body-wrapper'><div class='grid-edit-row'><form class='grid-edit-form'></form></div><div class='gird-edit-btn'><input type='button' class='ok' value='确定'/><input type='button' class='cancel' value='取消'/></div></div></div>").width(w.outerWidth()).insertAfter(w);var F=G.find(".gird-edit-btn"),C=F.prev(".grid-edit-row"),E;H._editView={view:G,editRow:C,editBtn:F};E=v(H);F.css({left:E.left,top:E.top});var B=F.find("input.ok").omButton(),z=F.find("input.cancel").omButton();B.click(function(){if(H._validator&&!H._validator.form()){return}var I=w.find("tr[_grid_row_id='"+H._editView.rowId+"']");c(H,I);G.hide();H._editView.editing=false;B.blur();if(H._rowAdding){H._refreshHeaderCheckBox();H._rowAdding=false}var J=H._getTrs().index(I);x.onAfterEdit&&x.onAfterEdit.call(H,J,H._getRowData(J))});z.click(function(){H.cancelEdit(this)})}H._editView.rowId=a(D);if(H._editView.editing){G.animate({top:A.top+y},"fast")}else{G.css({top:A.top+y});H._editView.editing=true;G.show();if(H._colWidthResize){o(H);H._colWidthResize=false}}}function j(){if(!i(this)||!this._triggered){return}if(this._editView.editing){this.element.parent().scrollLeft(0);var w=this;setTimeout(function(){o(w)},0)}else{this._colWidthResize=true}}function o(F,C,y){var w=F.element,B=F._editView,E=B.view,x=w.parent().scrollLeft(),D=B.editBtn,z;E.width(w.outerWidth());F._getHeaderCols().each(function(G,I){var K=d(I).attr("abbr"),H=d(I),J=C&&C.prop("abbr")===H.prop("abbr");if(J){z=true}if(C&&!z){return}d.each(F._editComps,function(M,L){var O=L.instance,N=L.type;if(K==L.id){if(!J&&C){O.closest("div.grid-edit-wrapper").css("left","+="+y);return false}if(!J){O.closest("div.grid-edit-wrapper").width(H.outerWidth()).css("left",H.position().left+x)}if("omCalendar"==N||"omCombo"==N){var P=O.parent();if("omCalendar"==N){O.width(H.outerWidth()-24);O.width(H.outerWidth(true)-(P.outerWidth(true)-O.width()))}else{O.next("input").width(H.outerWidth(true)-(P.outerWidth(true)-O.next("input").width()))}}else{O.width(H.outerWidth(true)-(O.outerWidth(true)-O.width()))}}})});var A=v(F);if(C){D.animate({left:A.left,top:A.top},"fast")}else{D.css({left:A.left,top:A.top})}}function k(w,x){if(!i(this)||!this._triggered||!this._editView.editing){this._colWidthResize=true;return}o(this,w,x)}function c(w,A){var y=d(A),D=w._editView.editRow,C=w._editComps,B=a(y),x=w._getTrs().index(y),z=w._getRowData(x);d.each(C,function(G,F){var I=F.model.name,K=e(w,y,F),E,H,J;if(y.attr("_insert")){w._changeData.insert[B][I]=K}else{E=u(w,A)[I];J=w._changeData.update[B];if(String(K)===String(E)){m(y,F.model,false);J&&delete J[I];d.isEmptyObject(J)&&delete w._changeData.update[B]}else{m(y,F.model,true);J=w._changeData.update[B]=J||{};J[I]=K}}if(F.model.renderer){H=F.model.renderer(K,z,x)}else{H=K==undefined?"":K}y.find("td[abbr='"+I+"'] >div").html(H)})}function m(y,x,w){y.find("td[abbr='"+x.name+"']").toggleClass("grid-cell-dirty",w)}function a(w){return d(w).attr("_grid_row_id")}function e(x,z,w){var B,A=u(x,z),y=w.instance;switch(w.type){case"omCalendar":B=y.val();case"omNumberField":B=y.val();break;case"omCombo":B=y.omCombo("value");break;case"text":B=y.val();break;case"custom":if(w.model.editor.getValue){return w.model.editor.getValue.call(y,A,w.model.name)}default:break}return B}function n(w,A,z){var B,y=z.name;if(A.attr("_insert")){B=u(w,A)[y]}else{var x=w._changeData.update[a(A)];if(x&&x[y]!=null){B=x[y]}else{B=u(w,A)[y]}}return B}function u(w,x){var y=a(x);return d(x).attr("_insert")?w._changeData.insert[y]:w._rowIdDataMap[y]}function p(x){var w=x._editView.editRow.find(">.grid-edit-form"),A={},B=A.rules={},z=A.messages={},y=x._getColModel();d.each(y,function(I,G){var H=G.editor.rules;if(H){var C=B[G.editor.name||G.name]={},E=z[G.editor.name||G.name]={};if(H.length>0&&!d.isArray(H[0])){var K=[];K.push(H);H=K}for(var F=0,J=H.length;F<J;F++){var D=H[F][0];C[D]=H[F][1]==undefined?true:H[F][1];if(H[F][2]){E[D]=H[F][2]}}}});d.extend(A,{onkeyup:function(C){this.element(C)},errorPlacement:function(C,D){},showErrors:function(E,F){if(F&&F.length>0){d.each(F,function(K,M){var I=d(M.element),J=I.attr("name");var L=x._errorHolders[J];if(L){var H=I.offset(),G=x.element.offset();L.css({left:H.left-G.left+I.outerWidth(),top:H.top-G.top+I.outerHeight()}).html(M.message);if(I.is(":focus")){L.show()}}})}else{d.each(this.currentElements,function(G,H){var I=x._errorHolders[d(H).attr("name")];I&&I.empty().hide()})}var C=x._editView.editBtn.find("input.ok"),D=true;d.each(x._errorHolders,function(G,H){if(!H.is(":empty")){return D=false}});D?C.omButton("enable"):C.omButton("disable");this.defaultShowErrors()}});x._validator=w.validate(A);d.each(x._editComps,function(E,D){var G=D.model.editor;if(G.editable&&G.rules){var F=G.name||D.model.name,H=x._errorHolders[F],C=D.type=="omCombo"?D.instance.next("input"):D.instance;C.mouseover(function(){if(H&&!H.is(":empty")){H.show()}}).mouseout(function(){H&&H.hide()})}})}})(jQuery);(function(c){c.omWidget.addBeforeInitListener("om.omGrid",function(){var f=this._getColModel();if(!c.isArray(f)||f.length<=0||!c.isArray(f[0])){return}d(this);this.hDiv.addClass("hDiv-group-header");c.extend(this,{_getColModel:function(){return this._colModel},_getHeaderCols:function(){var g=[],j=this.options,i=this.hDiv,h=i.find("th[axis^='col']");c(h).each(function(){g.push(this)});g.sort(function(l,k){return l.axis.slice(3)-k.axis.slice(3)});!j.singleSelect&&g.unshift(i.find("th[axis='checkboxCol']")[0]);j.showIndex&&g.unshift(i.find("th[axis='indexCol']")[0]);j.rowDetailsProvider&&g.unshift(i.find("th[axis='expenderCol']")[0]);return c(g)},_buildTableHead:function(){var r=this.options,g=this.element,k=g.closest(".om-grid"),p=r.colModel,y=0,o=-1,A="<th class='$' $ $ $ $ $><div class='$' style='text-align:$; $'>$</div></th>",v=["<thead>"],u,z,m,s;for(var x=0,n=p.length;x<n;x++){v.push("<tr>");if(x==0){if(r.showIndex){v.push("<th class='indexCol data-header-"+n+"' align='center' axis='indexCol' rowspan="+n+"><div class='indexheader' style='text-align:center;width:25px;' /></th>")}if(!r.singleSelect){v.push("<th class='checkboxCol data-header-"+n+"' align='center' axis='checkboxCol' rowspan="+n+"><div class='checkboxheader' style='text-align:center;width:17px;'><span class='checkbox'/></div></th>")}}m=p[x];for(var w=0,l=m.length;w<l;w++){z=m[w];var q=z.width||60,t=z.align||"center",B=z.name;if(z.name&&q=="autoExpand"){q=0;o=b(this,z)}var h=z.wrap?"wrap":"";h+=(z.name?" data-header-":" group-header-")+(z.rowspan?z.rowspan:1);u=[h,z.align?"align="+z.align:"",B?"axis=col"+b(this,z):"",B?"abbr="+B:"",z.rowspan?"rowspan="+z.rowspan:"",z.colspan?"colspan="+z.colspan:"",z.wrap?"wrap":"",t,B?"width:"+q+"px":"",z.header];e(v,u,A);if(z.name){y+=q}}v.push("</tr>")}v.push("</thead>");c("table",this.hDiv).html(v.join(""));s=c("thead",this.hDiv);this._fixHeaderWidth(o,y);this.thead=s;s=null}})});function b(h,k){var g=h._getColModel();for(var j=0,f=g.length;j<f;j++){if(g[j].name==k.name){return j}}}function e(h,i,g){var f=0;h.push(g.replace(/\$/g,function(){return i[f++]}))}function d(s){s._colModel=[];var p=s._getColModel(),o=[],k=[],u=1,n=1,m,r,q,l=p.length;for(var h=0;h<l;h++){o[h]=[]}for(var h=0,t=l;h<t;h++){m=p[h];for(var g=0,f=m.length;g<f;g++){r=m[g];u=r.rowspan||1;n=r.colspan||1;q=a(o,h,u,n);if(r.name){k.push({header:r,colIndex:q})}}}k.sort(function(j,i){return j.colIndex-i.colIndex});h=0;while(k[h]&&s._colModel.push(k[h++].header)){}}function a(g,l,n,o){var m=0;while(g[l][m]&&++m){}for(var h=l;h<l+n;h++){for(var f=m;f<m+o;f++){g[h][f]=true}}return m}})(jQuery);